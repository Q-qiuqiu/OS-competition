ä½¿ç”¨æ­è½½äº† Rockchip RK3588 èŠ¯ç‰‡çš„è¿…ä¸ºiTOP-3588å¼€å‘æ¿ï¼Œåœ¨æ­¤å¼€å‘æ¿ä¸Šå¼€å‘ä¸€ä¸ªå®¹å™¨å†…çš„å¤šçº¿ç¨‹è§£æè§†é¢‘çš„è§†é¢‘æµå¤„ç†ç³»ç»Ÿã€‚
```
â””â”€ ğŸ“RK3588
   â””â”€ ğŸ“video_decoder_docker_multiway_v2
      â”œâ”€ ğŸ“src                            //è§†é¢‘è§£ç ç¨‹åºçš„æºä»£ç 
      â”œâ”€ ğŸ“„Dockerfile                     //åˆ¶ä½œåŒ…å«æ‰€æœ‰è¿è¡Œç¯å¢ƒå’Œåº“æ–‡ä»¶çš„ docker image è¯­å¥ 
      â””â”€ ğŸ“„README.md                      //å¯åŠ¨dockerçš„æŒ‚è½½å‘½ä»¤å’Œç¨‹åºæ¥å£è¯´æ˜ç­‰.
```
ä½¿ç”¨ C++ ç¼–å†™è§†é¢‘è§£ç ç¨‹åºï¼Œæ¡†æ¶å†…æä¾› HTTP æ¥å£æ”¯æŒã€‚æ¥æ”¶åˆ°è§†é¢‘è®¾å¤‡ä¼ è¾“çš„è§†é¢‘åï¼Œä½¿ç”¨è‡ªèº«ç¡¬ä»¶è§£ç çš„æ–¹å¼å°†è§†é¢‘æµè§£ç æˆå¸§å›¾åƒï¼Œå†ä¼ è¾“ç»™ NPU æ¨ç†å¼€å‘æ¿ï¼Œæ¥æ”¶åˆ°å‰ç«¯å¼€å‘æ¿çš„HTTP è¯·æ±‚åï¼Œä¼šå…ˆå°†è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ï¼Œå¦‚æœæ¥æ”¶åˆ°NPUæ¨ç†å¼€å‘æ¿çš„è¿”å›ç»“æœåä»é˜Ÿåˆ—ä¸­é€‰å‡ºæœ€æ–°å­˜å…¥çš„HTTPè¯·æ±‚ï¼Œå¹¶å°†æ¨ç†ç»“æœå’Œå¸§å›¾åƒæ•°æ®ä¼ è¾“ç»™å‰ç«¯å¼€å‘æ¿ã€‚å¦‚æœé˜Ÿåˆ—ä¸­å­˜åœ¨ç­‰å¾…è¶…è¿‡500 ms çš„HTTPè¯·æ±‚ï¼Œä¼šå°†failedè¿”å›ï¼Œå¹¶ç§»å‡ºé˜Ÿåˆ—ã€‚

å…·ä½“è§†é¢‘è§£ç éƒ¨åˆ†æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="/image/è§†é¢‘è§£ç å¼€å‘æ¿æµç¨‹.png" alt="è§†é¢‘è§£ç å¼€å‘æ¿æµç¨‹" width="50%" />

è§†é¢‘è§£ç ç¨‹åºå‡½æ•°è°ƒç”¨å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="/image/è§†é¢‘è§£ç å‡½æ•°è°ƒç”¨.png" alt="è§†é¢‘è§£ç å‡½æ•°è°ƒç”¨" width="50%" />

éƒ¨ç½²æ­¥éª¤å¦‚ä¸‹ï¼š

æ„å»º

```bash
docker build -t video_decoder_multiway . --build-arg "http_proxy=http://192.168.137.1:2080" --build-arg "https_proxy=http://192.168.137.1:2080"
```

å¯åŠ¨

```bash
docker run -it --privileged \
    --device=/dev/dri \
    --device=/dev/dma_heap \
    --device=/dev/rga \
    --device=/dev/mpp_service \
    -p 8081:8080 \
    --name=video_decoder_multiway \
    video_decoder_multiway:latest
```

```
docker exec -it video_decoder_multiway /bin/bash
```

åœæ­¢

```bash
docker stop video_decoder_multiway && docker rm video_decoder_multiway
```

å¼€å§‹å¤„ç†è§†é¢‘è¯·æ±‚ï¼š

```
POST http://192.168.137.2:8081/start?url=xxx
```
å¼€å§‹å¤„ç†è§†é¢‘è¯·æ±‚çš„å“åº”ï¼š

```
æˆåŠŸï¼Œstatusä¸ºsuccessï¼š
{
    "status": "success"
}
å¤±è´¥ï¼Œstatusä¸ºfailedï¼š
{
    "status": "failed",
    "reason": "<reason>"
}
```

åœæ­¢å¤„ç†è§†é¢‘è¯·æ±‚ï¼š

```
POST http://192.168.137.2:8081/stop?url=xxx
```

åœæ­¢å¤„ç†è§†é¢‘è¯·æ±‚çš„å“åº”ï¼š

```
æˆåŠŸï¼š
{
    "status": "success"
}
å¤±è´¥ï¼š
{
    "status": "failed",
    "reason": "<reason>"
}
```

è·å–è§†é¢‘å¸§è¯·æ±‚ï¼š

```
GET http://192.168.137.2:8081/video?url=xxx
```

è·å–è§†é¢‘è¯·æ±‚çš„å“åº”ï¼š

```
æ€»ä½“å½¢å¼ä¸ºï¼š
jsonæ•°æ®+!å­—ç¬¦+äºŒè¿›åˆ¶è§†é¢‘å¸§ï¼ˆBGRæ ¼å¼ï¼‰
```

æµ‹è¯•æ ·ä¾‹çš„jsonæ•°æ®ï¼š

1. æˆåŠŸ

```
{
    "result": [
        [
            269.28125,
            197.75,
            392.71875,
            359.25,
            0.7147121429443359,
            41
        ],
        [
            596.15625,
            246.5625,
            639.84375,
            357.9375,
            0.49903178215026855,
            24
        ],
        [
            15.8125,
            295.171875,
            88.0625,
            358.328125,
            0.27820515632629395,
            41
        ],
        [
            444.40625,
            299.125,
            531.59375,
            360.375,
            0.27074623107910156,
            64
        ]
    ],
    "status": "success",
    "width": 480,
    "height": 360
}
```

æˆåŠŸä½†æ²¡æœ‰æ¨ç†ç»“æœï¼š

```
{
    "result": [],
    "status": "success",
    "width": 480,
    "height": 360
}
```

å¤±è´¥ï¼š

```
{
    "status": "failed",
    "reason": "<reason>"
}
```
